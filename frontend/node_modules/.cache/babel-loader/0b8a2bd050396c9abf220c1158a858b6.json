{"ast":null,"code":"var _jsxFileName = \"/Users/jokizi/Documents/GitHub/BrunettiJoris_7_27052021/frontend/src/components/ProfilDetails/ProfilDetails.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { useHistory } from \"react-router\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport InputTextArea from \"../../components/Input/InputTextARea\";\nimport Button from \"../Button/Button\";\nimport Switch from \"@material-ui/core/Switch\";\nimport ConfirmPopUp from \"../ConfirmPopUp/ConfirmPopUp\";\nimport api from \"../../Config/Api\";\nimport { toastTrigger } from \"../../helper/toast\";\nimport Avatar from \"../Avatars/Avatars\";\nimport \"./profil-details.css\";\nimport ModifCommentPopUp from \"../ModifCommentPopUp/ModifCommentPopUP\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst ProfilDetails = ({\n  myUserId,\n  setIsLoggedin,\n  setCheckLogin\n}) => {\n  _s();\n\n  const [openUpdate, setOpenUpdate] = useState(false);\n  const [openDelete, setOpenDelete] = useState(false);\n  const history = useHistory();\n  const [email, setEmail] = useState(\"\");\n  const [pseudonyme, setPseudonyme] = useState(\"\");\n  const [isDisable, setIsDisable] = useState(true);\n  const [bio, setBio] = useState(\"\");\n  const [avatar, setAvatar] = useState(\"\");\n  const [isAdmin, setIsAdmin] = useState(null);\n  const [open, setOpen] = useState(false);\n  const [openUsername, setOpenUsername] = useState(false);\n  const [newUsername, setNewUsername] = useState(\"\");\n  const groupomaniaUser = JSON.parse(sessionStorage.getItem(\"groupomania-user\"));\n  useEffect(() => {\n    if (sessionStorage.getItem(\"groupomania-user\")) {\n      setEmail(groupomaniaUser.email);\n      setPseudonyme(groupomaniaUser.username);\n      setBio(groupomaniaUser.bio);\n      setAvatar(groupomaniaUser.avatar);\n      setIsAdmin(groupomaniaUser.isAdmin);\n    } else {\n      history.push(\"/\");\n    }\n  }, [history, groupomaniaUser.email, groupomaniaUser.username, groupomaniaUser.bio, groupomaniaUser.avatar, groupomaniaUser.isAdmin]);\n\n  const onChangeAvatar = newAvatar => {\n    setAvatar(newAvatar);\n  };\n\n  const onChangeBio = e => {\n    setBio(e.target.value);\n  };\n\n  const onChangeUsername = e => {\n    setNewUsername(e.target.value);\n  };\n\n  const handleUpdate = () => {\n    setIsDisable(!isDisable);\n  };\n\n  const handleUpdateModal = () => {\n    setOpenUpdate(!openUpdate);\n  };\n\n  const handleDeleteModal = () => {\n    setOpenDelete(!openDelete);\n  };\n\n  const handleModal = () => {\n    setOpen(!open);\n  };\n\n  const handleUpdateUsername = () => {\n    setOpenUsername(!openUsername);\n  };\n\n  const onUpdateUsername = async () => {\n    const token = JSON.parse(JSON.stringify(sessionStorage.getItem(\"groupomania-token\")));\n\n    if (newUsername === groupomaniaUser.username) {\n      toastTrigger(\"error\", \"Une erreur est survenue ⛔️\");\n      setOpenUsername(false);\n      return;\n    }\n\n    try {\n      const response = await api({\n        url: \"/users/username/\",\n        method: \"put\",\n        data: {\n          username: newUsername\n        },\n        headers: {\n          Authorization: `Bearer ${token}`,\n          Accept: \"application/json\"\n        }\n      });\n      setOpenUsername(false);\n      let oldSessionStorage = groupomaniaUser;\n      oldSessionStorage.username = response.data.username;\n      sessionStorage.setItem(\"groupomania-user\", JSON.stringify(oldSessionStorage));\n      setPseudonyme(response.data.username);\n      toastTrigger(\"success\", \"Profil Mis à Jour 👌🏼\");\n    } catch (error) {\n      toastTrigger(\"error\", \"Une erreur est survenue ⛔️\");\n    }\n  };\n\n  const onUpdateBio = async () => {\n    const token = JSON.parse(JSON.stringify(sessionStorage.getItem(\"groupomania-token\")));\n\n    if (bio === groupomaniaUser.bio) {\n      toastTrigger(\"error\", \"Une erreur est survenue ⛔️\");\n      setOpenUpdate(false);\n      return;\n    }\n\n    try {\n      const response = await api({\n        url: \"/users/profile/\",\n        method: \"put\",\n        data: {\n          bio\n        },\n        headers: {\n          Authorization: `Bearer ${token}`,\n          Accept: \"application/json\"\n        }\n      });\n      let oldSessionStorage = groupomaniaUser;\n      oldSessionStorage.bio = response.data.bio;\n      sessionStorage.setItem(\"groupomania-user\", JSON.stringify(oldSessionStorage));\n      setOpenUpdate(!openUpdate);\n      setIsDisable(true);\n      toastTrigger(\"success\", \"Profil Mis à Jour 👌🏼\");\n    } catch (error) {\n      toastTrigger(\"error\", \"Une erreur est survenue ⛔️\");\n    }\n  };\n\n  const onDeleteUser = async () => {\n    const token = JSON.parse(JSON.stringify(sessionStorage.getItem(\"groupomania-token\")));\n\n    try {\n      await api({\n        url: \"/user/\" + myUserId,\n        method: \"delete\",\n        headers: {\n          Authorization: `Bearer ${token}`,\n          Accept: \"application/json\",\n          \"Content-Type\": \"multipart/from-data\"\n        }\n      });\n      setCheckLogin(false);\n      setIsLoggedin(false);\n      sessionStorage.removeItem(\"groupomania-token\");\n      sessionStorage.removeItem(\"groupomania-user\");\n      history.push(\"/\");\n    } catch (error) {}\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"user-profil-big-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"user-profil-title\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: \"Mon Profil\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"user-profil-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"avatar-container\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: \"Avatar :\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"avatar-picture\",\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              width: \"100%\",\n              height: \"100%\",\n              style: {\n                borderRadius: \"50%\"\n              },\n              src: avatar\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 171,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"user-button-modify-avatar\",\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              onClick: handleModal,\n              title: \"Modifier Avatar\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 174,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Avatar, {\n            onChangeAvatar: onChangeAvatar,\n            open: open,\n            close: handleModal\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 176,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"user-name-container\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"user-email\",\n            children: [\" e-mail : \", email, \" \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"user-name\",\n            children: [\"Pseudonyme : \", pseudonyme]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message-is-admin\",\n            children: [isAdmin && /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n              color: \"#fc930c\",\n              icon: [\"fas\", \"user-cog\"]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 183,\n              columnNumber: 27\n            }, this), \" \", isAdmin && \"Administrateur\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 182,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"modify-icon\",\n            onClick: handleUpdateUsername,\n            children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n              color: \"blue\",\n              icon: [\"far\", \"edit\"]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 186,\n              columnNumber: 15\n            }, this), \" modifier pseudonyme\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(ModifCommentPopUp, {\n            open: openUsername,\n            onChange: onChangeUsername,\n            handleModal: handleUpdateUsername,\n            onUpdate: onUpdateUsername,\n            modalTitle: \"Modifier votre pseudonyme\",\n            label: \"Modifier pseudonyme\",\n            buttonTitle1: \"Sauvegarder Modifications\",\n            buttonTitle2: \"Annuler Modifications\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"user-description-container\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"user-description-input\",\n            children: /*#__PURE__*/_jsxDEV(InputTextArea, {\n              disabled: isDisable,\n              rows: 4,\n              variant: \"outlined\",\n              label: \"Description\",\n              onChange: onChangeBio,\n              value: bio\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 201,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [\"Mettre \\xE0 jour votre description :\", /*#__PURE__*/_jsxDEV(\"div\", {\n              children: /*#__PURE__*/_jsxDEV(Switch, {\n                color: \"primary\",\n                checked: !isDisable,\n                onChange: handleUpdate,\n                name: \"UpdateBio\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 213,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 212,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"button-modify-bio\",\n              children: [/*#__PURE__*/_jsxDEV(Button, {\n                onClick: handleUpdateModal,\n                title: \"Modifier Ma Description\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 216,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(ConfirmPopUp, {\n                open: openUpdate,\n                handleModal: handleUpdateModal,\n                modalTitle: \"Modifier la Description ?\",\n                buttonTitle1: \"Oui\",\n                buttonTitle2: \"Non\",\n                confirmModalAction: onUpdateBio,\n                bio: bio,\n                setBio: setBio\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 217,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 215,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 210,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"button-delete-my-account\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            onClick: handleDeleteModal,\n            title: \"Supprimer Mon Compte\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(ConfirmPopUp, {\n            open: openDelete,\n            handleModal: handleDeleteModal,\n            confirmModalAction: onDeleteUser,\n            modalTitle: \"Supprimer votre compte ?\",\n            buttonTitle1: \"Oui\",\n            buttonTitle2: \"Non\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 233,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 162,\n    columnNumber: 5\n  }, this);\n};\n\n_s(ProfilDetails, \"9i8gJOIGbGRHI6ZyRihttyWWfyc=\", false, function () {\n  return [useHistory];\n});\n\n_c = ProfilDetails;\nexport default ProfilDetails;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProfilDetails\");","map":{"version":3,"sources":["/Users/jokizi/Documents/GitHub/BrunettiJoris_7_27052021/frontend/src/components/ProfilDetails/ProfilDetails.js"],"names":["React","useState","useEffect","useHistory","FontAwesomeIcon","InputTextArea","Button","Switch","ConfirmPopUp","api","toastTrigger","Avatar","ModifCommentPopUp","ProfilDetails","myUserId","setIsLoggedin","setCheckLogin","openUpdate","setOpenUpdate","openDelete","setOpenDelete","history","email","setEmail","pseudonyme","setPseudonyme","isDisable","setIsDisable","bio","setBio","avatar","setAvatar","isAdmin","setIsAdmin","open","setOpen","openUsername","setOpenUsername","newUsername","setNewUsername","groupomaniaUser","JSON","parse","sessionStorage","getItem","username","push","onChangeAvatar","newAvatar","onChangeBio","e","target","value","onChangeUsername","handleUpdate","handleUpdateModal","handleDeleteModal","handleModal","handleUpdateUsername","onUpdateUsername","token","stringify","response","url","method","data","headers","Authorization","Accept","oldSessionStorage","setItem","error","onUpdateBio","onDeleteUser","removeItem","borderRadius"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useHistory } from \"react-router\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport InputTextArea from \"../../components/Input/InputTextARea\";\nimport Button from \"../Button/Button\";\nimport Switch from \"@material-ui/core/Switch\";\nimport ConfirmPopUp from \"../ConfirmPopUp/ConfirmPopUp\";\nimport api from \"../../Config/Api\";\nimport { toastTrigger } from \"../../helper/toast\";\nimport Avatar from \"../Avatars/Avatars\";\nimport \"./profil-details.css\";\nimport ModifCommentPopUp from \"../ModifCommentPopUp/ModifCommentPopUP\";\n\nconst ProfilDetails = ({ myUserId, setIsLoggedin, setCheckLogin }) => {\n  const [openUpdate, setOpenUpdate] = useState(false);\n  const [openDelete, setOpenDelete] = useState(false);\n  const history = useHistory();\n  const [email, setEmail] = useState(\"\");\n  const [pseudonyme, setPseudonyme] = useState(\"\");\n  const [isDisable, setIsDisable] = useState(true);\n  const [bio, setBio] = useState(\"\");\n  const [avatar, setAvatar] = useState(\"\");\n  const [isAdmin, setIsAdmin] = useState(null);\n  const [open, setOpen] = useState(false);\n  const [openUsername, setOpenUsername] = useState(false);\n  const [newUsername, setNewUsername] = useState(\"\");\n  const groupomaniaUser = JSON.parse(sessionStorage.getItem(\"groupomania-user\"));\n\n  useEffect(() => {\n    if (sessionStorage.getItem(\"groupomania-user\")) {\n      setEmail(groupomaniaUser.email);\n      setPseudonyme(groupomaniaUser.username);\n      setBio(groupomaniaUser.bio);\n      setAvatar(groupomaniaUser.avatar);\n      setIsAdmin(groupomaniaUser.isAdmin);\n    } else {\n      history.push(\"/\");\n    }\n  }, [\n    history,\n    groupomaniaUser.email,\n    groupomaniaUser.username,\n    groupomaniaUser.bio,\n    groupomaniaUser.avatar,\n    groupomaniaUser.isAdmin,\n  ]);\n\n  const onChangeAvatar = (newAvatar) => {\n    setAvatar(newAvatar);\n  };\n\n  const onChangeBio = (e) => {\n    setBio(e.target.value);\n  };\n\n  const onChangeUsername = (e) => {\n    setNewUsername(e.target.value);\n  };\n\n  const handleUpdate = () => {\n    setIsDisable(!isDisable);\n  };\n\n  const handleUpdateModal = () => {\n    setOpenUpdate(!openUpdate);\n  };\n\n  const handleDeleteModal = () => {\n    setOpenDelete(!openDelete);\n  };\n\n  const handleModal = () => {\n    setOpen(!open);\n  };\n\n  const handleUpdateUsername = () => {\n    setOpenUsername(!openUsername);\n  };\n\n  const onUpdateUsername = async () => {\n    const token = JSON.parse(JSON.stringify(sessionStorage.getItem(\"groupomania-token\")));\n    if (newUsername === groupomaniaUser.username) {\n      toastTrigger(\"error\", \"Une erreur est survenue ⛔️\");\n      setOpenUsername(false);\n      return;\n    }\n    try {\n      const response = await api({\n        url: \"/users/username/\",\n        method: \"put\",\n        data: { username: newUsername },\n        headers: {\n          Authorization: `Bearer ${token}`,\n          Accept: \"application/json\",\n        },\n      });\n\n      setOpenUsername(false);\n\n      let oldSessionStorage = groupomaniaUser;\n      oldSessionStorage.username = response.data.username;\n      sessionStorage.setItem(\"groupomania-user\", JSON.stringify(oldSessionStorage));\n      setPseudonyme(response.data.username);\n      toastTrigger(\"success\", \"Profil Mis à Jour 👌🏼\");\n    } catch (error) {\n      toastTrigger(\"error\", \"Une erreur est survenue ⛔️\");\n    }\n  };\n\n  const onUpdateBio = async () => {\n    const token = JSON.parse(JSON.stringify(sessionStorage.getItem(\"groupomania-token\")));\n    if (bio === groupomaniaUser.bio) {\n      toastTrigger(\"error\", \"Une erreur est survenue ⛔️\");\n      setOpenUpdate(false);\n      return;\n    }\n    try {\n      const response = await api({\n        url: \"/users/profile/\",\n        method: \"put\",\n        data: { bio },\n        headers: {\n          Authorization: `Bearer ${token}`,\n          Accept: \"application/json\",\n        },\n      });\n\n      let oldSessionStorage = groupomaniaUser;\n      oldSessionStorage.bio = response.data.bio;\n      sessionStorage.setItem(\"groupomania-user\", JSON.stringify(oldSessionStorage));\n      setOpenUpdate(!openUpdate);\n\n      setIsDisable(true);\n      toastTrigger(\"success\", \"Profil Mis à Jour 👌🏼\");\n    } catch (error) {\n      toastTrigger(\"error\", \"Une erreur est survenue ⛔️\");\n    }\n  };\n\n  const onDeleteUser = async () => {\n    const token = JSON.parse(JSON.stringify(sessionStorage.getItem(\"groupomania-token\")));\n\n    try {\n      await api({\n        url: \"/user/\" + myUserId,\n        method: \"delete\",\n        headers: {\n          Authorization: `Bearer ${token}`,\n          Accept: \"application/json\",\n          \"Content-Type\": \"multipart/from-data\",\n        },\n      });\n      setCheckLogin(false);\n      setIsLoggedin(false);\n      sessionStorage.removeItem(\"groupomania-token\");\n      sessionStorage.removeItem(\"groupomania-user\");\n      history.push(\"/\");\n    } catch (error) {}\n  };\n\n  return (\n    <div>\n      <div className=\"user-profil-big-container\">\n        <div className=\"user-profil-title\">\n          <div>Mon Profil</div>\n        </div>\n        <div className=\"user-profil-container\">\n          <div className=\"avatar-container\">\n            <div>Avatar :</div>\n            <div className=\"avatar-picture\">\n              <img width=\"100%\" height=\"100%\" style={{ borderRadius: \"50%\" }} src={avatar} />\n            </div>\n            <div className=\"user-button-modify-avatar\">\n              <Button onClick={handleModal} title=\"Modifier Avatar\" />\n            </div>\n            <Avatar onChangeAvatar={onChangeAvatar} open={open} close={handleModal} />\n          </div>\n\n          <div className=\"user-name-container\">\n            <div className=\"user-email\"> e-mail : {email} </div>\n            <div className=\"user-name\">Pseudonyme : {pseudonyme}</div>\n            <div className=\"message-is-admin\">\n              {isAdmin && <FontAwesomeIcon color=\"#fc930c\" icon={[\"fas\", \"user-cog\"]} />} {isAdmin && \"Administrateur\"}\n            </div>\n            <div className=\"modify-icon\" onClick={handleUpdateUsername}>\n              <FontAwesomeIcon color=\"blue\" icon={[\"far\", \"edit\"]} /> modifier pseudonyme\n            </div>\n            <ModifCommentPopUp\n              open={openUsername}\n              onChange={onChangeUsername}\n              handleModal={handleUpdateUsername}\n              onUpdate={onUpdateUsername}\n              modalTitle=\"Modifier votre pseudonyme\"\n              label=\"Modifier pseudonyme\"\n              buttonTitle1=\"Sauvegarder Modifications\"\n              buttonTitle2=\"Annuler Modifications\"\n            />\n          </div>\n          <div className=\"user-description-container\">\n            <div className=\"user-description-input\">\n              <InputTextArea\n                disabled={isDisable}\n                rows={4}\n                variant=\"outlined\"\n                label=\"Description\"\n                onChange={onChangeBio}\n                value={bio}\n              />\n            </div>\n            <div>\n              Mettre à jour votre description :\n              <div>\n                <Switch color=\"primary\" checked={!isDisable} onChange={handleUpdate} name=\"UpdateBio\" />\n              </div>\n              <div className=\"button-modify-bio\">\n                <Button onClick={handleUpdateModal} title=\"Modifier Ma Description\" />\n                <ConfirmPopUp\n                  open={openUpdate}\n                  handleModal={handleUpdateModal}\n                  modalTitle=\"Modifier la Description ?\"\n                  buttonTitle1=\"Oui\"\n                  buttonTitle2=\"Non\"\n                  confirmModalAction={onUpdateBio}\n                  bio={bio}\n                  setBio={setBio}\n                />\n              </div>\n            </div>\n          </div>\n\n          <div className=\"button-delete-my-account\">\n            <Button onClick={handleDeleteModal} title=\"Supprimer Mon Compte\" />\n            <ConfirmPopUp\n              open={openDelete}\n              handleModal={handleDeleteModal}\n              confirmModalAction={onDeleteUser}\n              modalTitle=\"Supprimer votre compte ?\"\n              buttonTitle1=\"Oui\"\n              buttonTitle2=\"Non\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\nexport default ProfilDetails;\n"]},"metadata":{},"sourceType":"module"}