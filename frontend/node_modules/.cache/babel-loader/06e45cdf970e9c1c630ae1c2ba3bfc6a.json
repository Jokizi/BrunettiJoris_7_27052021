{"ast":null,"code":"var _jsxFileName = \"/Users/jokizi/Documents/GitHub/BrunettiJoris_7_27052021/frontend/src/container/OtherProfil/OtherProfil.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { useHistory } from \"react-router\";\nimport api from \"../../Config/Api\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport LikeDislikeMessage from \"../../components/LikeMessage/LikeMessage\";\nimport CommentMessage from \"../../components/CommentMessage/CommentMessage\";\nimport ModifyMessage from \"../../components/ModifyMessage/ModifyMessage\";\nimport DeleteMessage from \"../../components/DeleteMessage/DeleteMessage\";\nimport Button from \"../../components/Button/Button\";\nimport ConfirmPopUp from \"../../components/ConfirmPopUp/ConfirmPopUp\";\nimport { toastTrigger } from \"../../helper/toast\";\nimport \"./other-profil.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst OtherProfil = ({\n  myUserId,\n  admin,\n  setIsLoggedin,\n  setCheckLogin\n}) => {\n  _s();\n\n  const [infoPseudonyme, setInfoPseudonyme] = useState(\"\");\n  const [infoBio, setInfoBio] = useState(\"\");\n  const [infoAvatar, setInfoAvatar] = useState(\"\");\n  const [messagesOtherUser, setMessagesOtherUser] = useState([]);\n  const [openDelete, setOpenDelete] = useState(false);\n  const [openAdminOtherUser, setOpenAdminOtherUser] = useState(false);\n  const [isOtherUserAdmin, setIsOtherUserAdmin] = useState(null);\n  const history = useHistory();\n  const groupomaniaUser = JSON.parse(sessionStorage.getItem(\"groupomania-user\"));\n  useEffect(() => {\n    var _history$location, _history$location$sta;\n\n    if ((_history$location = history.location) === null || _history$location === void 0 ? void 0 : (_history$location$sta = _history$location.state) === null || _history$location$sta === void 0 ? void 0 : _history$location$sta.id) {\n      const getInfos = async () => {\n        const token = JSON.parse(JSON.stringify(sessionStorage.getItem(\"groupomania-token\")));\n\n        try {\n          const response = await api({\n            url: history.location.state.id + \"/profile/\",\n            method: \"get\",\n            headers: {\n              Authorization: `Bearer ${token}`\n            }\n          });\n          setInfoAvatar(response.data.avatar);\n          setInfoPseudonyme(response.data.username);\n          setInfoBio(response.data.bio);\n          setIsOtherUserAdmin(response.data.isAdmin);\n\n          try {\n            const response = await api({\n              url: \"/view/\" + history.location.state.id + \"/messages\",\n              method: \"get\",\n              headers: {\n                Authorization: `Bearer ${token}`\n              }\n            });\n            setMessagesOtherUser(response.data);\n          } catch (error) {}\n        } catch (error) {}\n      };\n\n      getInfos();\n    } else {\n      history.push(\"/\");\n    }\n  }, [history]);\n\n  const handleDeleteModal = () => {\n    setOpenDelete(!openDelete);\n  };\n\n  const handleAdminToUserModal = () => {\n    setOpenAdminOtherUser(!openAdminOtherUser);\n  };\n\n  const adminPower = async () => {\n    try {\n      const token = JSON.parse(JSON.stringify(sessionStorage.getItem(\"groupomania-token\")));\n      const response = await api({\n        method: \"put\",\n        url: \"/users/\" + history.location.state.id,\n        headers: {\n          Authorization: `Bearer ${token}`,\n          Accept: \"application/json\"\n        }\n      });\n      setOpenAdminOtherUser(false);\n      setIsOtherUserAdmin(response.data);\n      toastTrigger(\"success\", \"Les droits administrateur sont réattribués 👌🏼\");\n    } catch (error) {\n      toastTrigger(\"error\", \"Une erreur est survenue ⛔️\");\n    }\n  };\n\n  const onDeleteOtherUser = async () => {\n    const token = JSON.parse(JSON.stringify(sessionStorage.getItem(\"groupomania-token\")));\n\n    try {\n      await api({\n        url: \"/user/\" + history.location.state.id,\n        method: \"delete\",\n        headers: {\n          Authorization: `Bearer ${token}`,\n          Accept: \"application/json\",\n          \"Content-Type\": \"multipart/from-data\"\n        }\n      });\n      toastTrigger(\"success\", \"Ce compte utilisateur à été supprimé 👌🏼\");\n      history.push(\"/\");\n    } catch (error) {\n      toastTrigger(\"error\", \"Une erreur est survenue ⛔️\");\n    }\n  };\n\n  const changeLike = ({\n    messageId,\n    like,\n    dislike\n  }) => {\n    const displayLike = messagesOtherUser.filter(element => {\n      if (element.id === messageId) {\n        element.likes = like;\n        element.dislikes = dislike;\n      }\n\n      return element;\n    });\n    setMessagesOtherUser(displayLike);\n  };\n\n  const changeComment = ({\n    messageId,\n    comments\n  }) => {\n    const displayComment = messagesOtherUser.filter(element => {\n      if (element.id === messageId) {\n        element.comments = comments;\n      }\n\n      return element;\n    });\n    setMessagesOtherUser(displayComment);\n  }; // rendre dynamique la suppression de message\n\n\n  const changeDeleteMessage = messageId => {\n    const idToDelete = messageId;\n    const displayMessages = messagesOtherUser.filter(element => element.id !== idToDelete);\n    setMessagesOtherUser(displayMessages);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"profil-details-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"users-profil-big-container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"users-profil-infos\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"users-avatar\",\n          children: [\"Avatar :\", /*#__PURE__*/_jsxDEV(\"img\", {\n            className: \"avatar-picture\",\n            src: infoAvatar\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"other-user-pseudo\",\n          children: [\"Pseudonyme : \", infoPseudonyme]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"message-is-admin\",\n          children: [isOtherUserAdmin && /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n            color: \"#fc930c\",\n            icon: [\"fas\", \"user-cog\"]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 34\n          }, this), \" \", isOtherUserAdmin && \"Administrateur\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"other-user-bio\",\n          children: [\"Description : \", infoBio]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 9\n      }, this), admin && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"users-buttons-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"users-button-be-admin\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            onClick: handleAdminToUserModal,\n            title: isOtherUserAdmin ? \"Retirer les droits\" : \"Donner les droits\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(ConfirmPopUp, {\n            open: openAdminOtherUser,\n            handleModal: handleAdminToUserModal,\n            confirmModalAction: adminPower,\n            modalTitle: \"Donner ou Enlever les droits administrateur \\xE0 cet utilisateur ?\",\n            buttonTitle1: \"Oui\",\n            buttonTitle2: \"Non\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            onClick: handleDeleteModal,\n            title: \"Supprimer Son Compte\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(ConfirmPopUp, {\n            open: openDelete,\n            handleModal: handleDeleteModal,\n            confirmModalAction: onDeleteOtherUser,\n            modalTitle: \"Supprimer le compte de cet Utilisateur ?\",\n            buttonTitle1: \"Oui\",\n            buttonTitle2: \"Non\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 160,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"message-other-user-card-container\",\n      children: messagesOtherUser.map(element => {\n        var _element$Likes;\n\n        const messageLikeByCurrentUser = element === null || element === void 0 ? void 0 : (_element$Likes = element.Likes) === null || _element$Likes === void 0 ? void 0 : _element$Likes.filter(elt => groupomaniaUser.id === elt.userId);\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"message-other-user-card\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"avatar-name\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"avatar-picture\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                width: \"100%\",\n                height: \"100%\",\n                style: {\n                  borderRadius: \"50%\"\n                },\n                src: element.User.avatar\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 179,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 178,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: element.User.username\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 181,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message-is-admin\",\n            children: [element.User.isAdmin && /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n              color: \"#fc930c\",\n              icon: [\"fas\", \"user-cog\"]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 184,\n              columnNumber: 42\n            }, this), \" \", element.User.isAdmin && \"Administrateur\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message-date\",\n            children: element.createdAt\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message-container\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"message-title\",\n              children: element.title\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 189,\n              columnNumber: 17\n            }, this), element.attachment && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"picture-container\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: element.attachment,\n                alt: \"img\",\n                width: \"100%\",\n                height: \"100%\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 192,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"message-content\",\n              children: element.content\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 195,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(LikeDislikeMessage, {\n            changeLike: changeLike,\n            like: element.likes,\n            dislike: element.dislikes,\n            messageId: element.id,\n            messageLikeByCurrentUser: messageLikeByCurrentUser\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(CommentMessage, {\n            admin: admin,\n            setMessagesOtherUser: setMessagesOtherUser,\n            changeComment: changeComment,\n            comments: element.comments,\n            messageId: element.id,\n            myUserId: myUserId,\n            locationState: \"/view/\" + history.location.state.id + \"/messages\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(ModifyMessage, {\n            messagesOtherUser: messagesOtherUser,\n            admin: admin,\n            messageId: element.id,\n            title: element.title,\n            attachment: element.attachment,\n            oldAttachement: element.attachment,\n            content: element.content,\n            myUserId: myUserId,\n            idUserMessage: element.UserId,\n            setMessagesOtherUser: setMessagesOtherUser,\n            getMessagesURI: \"/view/\" + history.location.state.id + \"/messages\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 213,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(DeleteMessage, {\n            admin: admin,\n            changeDeleteMessage: changeDeleteMessage,\n            messageId: element.id,\n            myUserId: myUserId,\n            idUserMessage: element.UserId\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 226,\n            columnNumber: 15\n          }, this)]\n        }, element.id, true, {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 13\n        }, this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 128,\n    columnNumber: 5\n  }, this);\n};\n\n_s(OtherProfil, \"e9+QgVIPotr9/yIdPoq3feZQ9Cw=\", false, function () {\n  return [useHistory];\n});\n\n_c = OtherProfil;\nexport default OtherProfil;\n\nvar _c;\n\n$RefreshReg$(_c, \"OtherProfil\");","map":{"version":3,"sources":["/Users/jokizi/Documents/GitHub/BrunettiJoris_7_27052021/frontend/src/container/OtherProfil/OtherProfil.js"],"names":["React","useState","useEffect","useHistory","api","FontAwesomeIcon","LikeDislikeMessage","CommentMessage","ModifyMessage","DeleteMessage","Button","ConfirmPopUp","toastTrigger","OtherProfil","myUserId","admin","setIsLoggedin","setCheckLogin","infoPseudonyme","setInfoPseudonyme","infoBio","setInfoBio","infoAvatar","setInfoAvatar","messagesOtherUser","setMessagesOtherUser","openDelete","setOpenDelete","openAdminOtherUser","setOpenAdminOtherUser","isOtherUserAdmin","setIsOtherUserAdmin","history","groupomaniaUser","JSON","parse","sessionStorage","getItem","location","state","id","getInfos","token","stringify","response","url","method","headers","Authorization","data","avatar","username","bio","isAdmin","error","push","handleDeleteModal","handleAdminToUserModal","adminPower","Accept","onDeleteOtherUser","changeLike","messageId","like","dislike","displayLike","filter","element","likes","dislikes","changeComment","comments","displayComment","changeDeleteMessage","idToDelete","displayMessages","map","messageLikeByCurrentUser","Likes","elt","userId","borderRadius","User","createdAt","title","attachment","content","UserId"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useHistory } from \"react-router\";\nimport api from \"../../Config/Api\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport LikeDislikeMessage from \"../../components/LikeMessage/LikeMessage\";\nimport CommentMessage from \"../../components/CommentMessage/CommentMessage\";\nimport ModifyMessage from \"../../components/ModifyMessage/ModifyMessage\";\nimport DeleteMessage from \"../../components/DeleteMessage/DeleteMessage\";\nimport Button from \"../../components/Button/Button\";\nimport ConfirmPopUp from \"../../components/ConfirmPopUp/ConfirmPopUp\";\nimport { toastTrigger } from \"../../helper/toast\";\nimport \"./other-profil.css\";\n\nconst OtherProfil = ({ myUserId, admin, setIsLoggedin, setCheckLogin }) => {\n  const [infoPseudonyme, setInfoPseudonyme] = useState(\"\");\n  const [infoBio, setInfoBio] = useState(\"\");\n  const [infoAvatar, setInfoAvatar] = useState(\"\");\n  const [messagesOtherUser, setMessagesOtherUser] = useState([]);\n  const [openDelete, setOpenDelete] = useState(false);\n  const [openAdminOtherUser, setOpenAdminOtherUser] = useState(false);\n  const [isOtherUserAdmin, setIsOtherUserAdmin] = useState(null);\n\n  const history = useHistory();\n  const groupomaniaUser = JSON.parse(sessionStorage.getItem(\"groupomania-user\"));\n  useEffect(() => {\n    if (history.location?.state?.id) {\n      const getInfos = async () => {\n        const token = JSON.parse(JSON.stringify(sessionStorage.getItem(\"groupomania-token\")));\n        try {\n          const response = await api({\n            url: history.location.state.id + \"/profile/\",\n            method: \"get\",\n            headers: { Authorization: `Bearer ${token}` },\n          });\n\n          setInfoAvatar(response.data.avatar);\n          setInfoPseudonyme(response.data.username);\n          setInfoBio(response.data.bio);\n          setIsOtherUserAdmin(response.data.isAdmin);\n          try {\n            const response = await api({\n              url: \"/view/\" + history.location.state.id + \"/messages\",\n              method: \"get\",\n              headers: { Authorization: `Bearer ${token}` },\n            });\n            setMessagesOtherUser(response.data);\n          } catch (error) {}\n        } catch (error) {}\n      };\n      getInfos();\n    } else {\n      history.push(\"/\");\n    }\n  }, [history]);\n\n  const handleDeleteModal = () => {\n    setOpenDelete(!openDelete);\n  };\n\n  const handleAdminToUserModal = () => {\n    setOpenAdminOtherUser(!openAdminOtherUser);\n  };\n\n  const adminPower = async () => {\n    try {\n      const token = JSON.parse(JSON.stringify(sessionStorage.getItem(\"groupomania-token\")));\n      const response = await api({\n        method: \"put\",\n        url: \"/users/\" + history.location.state.id,\n        headers: { Authorization: `Bearer ${token}`, Accept: \"application/json\" },\n      });\n      setOpenAdminOtherUser(false);\n      setIsOtherUserAdmin(response.data);\n      toastTrigger(\"success\", \"Les droits administrateur sont réattribués 👌🏼\");\n    } catch (error) {\n      toastTrigger(\"error\", \"Une erreur est survenue ⛔️\");\n    }\n  };\n\n  const onDeleteOtherUser = async () => {\n    const token = JSON.parse(JSON.stringify(sessionStorage.getItem(\"groupomania-token\")));\n\n    try {\n      await api({\n        url: \"/user/\" + history.location.state.id,\n        method: \"delete\",\n        headers: {\n          Authorization: `Bearer ${token}`,\n          Accept: \"application/json\",\n          \"Content-Type\": \"multipart/from-data\",\n        },\n      });\n      toastTrigger(\"success\", \"Ce compte utilisateur à été supprimé 👌🏼\");\n      history.push(\"/\");\n    } catch (error) {\n      toastTrigger(\"error\", \"Une erreur est survenue ⛔️\");\n    }\n  };\n\n  const changeLike = ({ messageId, like, dislike }) => {\n    const displayLike = messagesOtherUser.filter((element) => {\n      if (element.id === messageId) {\n        element.likes = like;\n        element.dislikes = dislike;\n      }\n      return element;\n    });\n    setMessagesOtherUser(displayLike);\n  };\n  const changeComment = ({ messageId, comments }) => {\n    const displayComment = messagesOtherUser.filter((element) => {\n      if (element.id === messageId) {\n        element.comments = comments;\n      }\n      return element;\n    });\n    setMessagesOtherUser(displayComment);\n  };\n\n  // rendre dynamique la suppression de message\n  const changeDeleteMessage = (messageId) => {\n    const idToDelete = messageId;\n    const displayMessages = messagesOtherUser.filter((element) => element.id !== idToDelete);\n    setMessagesOtherUser(displayMessages);\n  };\n\n  return (\n    <div className=\"profil-details-container\">\n      <div className=\"users-profil-big-container\">\n        <div className=\"users-profil-infos\">\n          <div className=\"users-avatar\">\n            Avatar :\n            <img className=\"avatar-picture\" src={infoAvatar} />\n          </div>\n          <div className=\"other-user-pseudo\">Pseudonyme : {infoPseudonyme}</div>\n          <div className=\"message-is-admin\">\n            {isOtherUserAdmin && <FontAwesomeIcon color=\"#fc930c\" icon={[\"fas\", \"user-cog\"]} />}{\" \"}\n            {isOtherUserAdmin && \"Administrateur\"}\n          </div>\n          <div className=\"other-user-bio\">Description : {infoBio}</div>\n        </div>\n        {admin && (\n          <div className=\"users-buttons-container\">\n            <div className=\"users-button-be-admin\">\n              <Button\n                onClick={handleAdminToUserModal}\n                title={isOtherUserAdmin ? \"Retirer les droits\" : \"Donner les droits\"}\n              />\n              <ConfirmPopUp\n                open={openAdminOtherUser}\n                handleModal={handleAdminToUserModal}\n                confirmModalAction={adminPower}\n                modalTitle=\"Donner ou Enlever les droits administrateur à cet utilisateur ?\"\n                buttonTitle1=\"Oui\"\n                buttonTitle2=\"Non\"\n              />\n            </div>\n            <div>\n              <Button onClick={handleDeleteModal} title=\"Supprimer Son Compte\" />\n              <ConfirmPopUp\n                open={openDelete}\n                handleModal={handleDeleteModal}\n                confirmModalAction={onDeleteOtherUser}\n                modalTitle=\"Supprimer le compte de cet Utilisateur ?\"\n                buttonTitle1=\"Oui\"\n                buttonTitle2=\"Non\"\n              />\n            </div>\n          </div>\n        )}\n      </div>\n      <div className=\"message-other-user-card-container\">\n        {messagesOtherUser.map((element) => {\n          const messageLikeByCurrentUser = element?.Likes?.filter((elt) => groupomaniaUser.id === elt.userId);\n          return (\n            <div className=\"message-other-user-card\" key={element.id}>\n              <div className=\"avatar-name\">\n                <div className=\"avatar-picture\">\n                  <img width=\"100%\" height=\"100%\" style={{ borderRadius: \"50%\" }} src={element.User.avatar} />\n                </div>\n                <div>{element.User.username}</div>\n              </div>\n              <div className=\"message-is-admin\">\n                {element.User.isAdmin && <FontAwesomeIcon color=\"#fc930c\" icon={[\"fas\", \"user-cog\"]} />}{\" \"}\n                {element.User.isAdmin && \"Administrateur\"}\n              </div>\n              <div className=\"message-date\">{element.createdAt}</div>\n              <div className=\"message-container\">\n                <div className=\"message-title\">{element.title}</div>\n                {element.attachment && (\n                  <div className=\"picture-container\">\n                    <img src={element.attachment} alt=\"img\" width=\"100%\" height=\"100%\" />\n                  </div>\n                )}\n                <div className=\"message-content\">{element.content}</div>\n              </div>\n              <LikeDislikeMessage\n                changeLike={changeLike}\n                like={element.likes}\n                dislike={element.dislikes}\n                messageId={element.id}\n                messageLikeByCurrentUser={messageLikeByCurrentUser}\n              />\n              <CommentMessage\n                admin={admin}\n                setMessagesOtherUser={setMessagesOtherUser}\n                changeComment={changeComment}\n                comments={element.comments}\n                messageId={element.id}\n                myUserId={myUserId}\n                locationState={\"/view/\" + history.location.state.id + \"/messages\"}\n              />\n              <ModifyMessage\n                messagesOtherUser={messagesOtherUser}\n                admin={admin}\n                messageId={element.id}\n                title={element.title}\n                attachment={element.attachment}\n                oldAttachement={element.attachment}\n                content={element.content}\n                myUserId={myUserId}\n                idUserMessage={element.UserId}\n                setMessagesOtherUser={setMessagesOtherUser}\n                getMessagesURI={\"/view/\" + history.location.state.id + \"/messages\"}\n              />\n              <DeleteMessage\n                admin={admin}\n                changeDeleteMessage={changeDeleteMessage}\n                messageId={element.id}\n                myUserId={myUserId}\n                idUserMessage={element.UserId}\n              />\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\nexport default OtherProfil;\n"]},"metadata":{},"sourceType":"module"}