{"ast":null,"code":"var _jsxFileName = \"/Users/jokizi/Documents/GitHub/BrunettiJoris_7_27052021/frontend/src/components/ModifyMessage/ModifyMessage.js\",\n    _s = $RefreshSig$();\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport api from \"../../Config/Api\";\nimport { useState } from \"react\";\nimport ModifPopUp from \"../ModifPopUp/ModifPopUp\";\nimport FormData from \"form-data\";\nimport { toastTrigger } from \"../../helper/toast\";\nimport \"./modify-message.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst ModifyMessage = ({\n  messagesOtherUser,\n  admin,\n  myUserId,\n  idUserMessage,\n  messageId,\n  title,\n  content,\n  attachment,\n  oldAttachement,\n  setAllMessages,\n  setMessagesOtherUser,\n  getMessagesURI\n}) => {\n  _s();\n\n  const [open, setOpen] = useState(false);\n  const [newFile, setNewFile] = useState(attachment);\n  const [fileToSend, setFileToSend] = useState(\"\");\n  const [newTitle, setNewTitle] = useState(title);\n  const [newContent, setNewContent] = useState(content);\n\n  const handleModal = () => {\n    setOpen(!open);\n    setNewFile(oldAttachement);\n  };\n\n  const onUpdate = async () => {\n    const token = JSON.parse(JSON.stringify(sessionStorage.getItem(\"groupomania-token\")));\n    const obj = {\n      title: newTitle,\n      content: newContent\n    };\n    const json = JSON.stringify(obj);\n    const formData = new FormData();\n    formData.append(\"image\", fileToSend);\n    formData.append(\"message\", json);\n\n    if (title === newTitle && content === newContent && newFile === oldAttachement || newTitle === \"\" || newContent === \"\") {\n      toastTrigger(\"error\", \"Rien n'a √©t√© modifi√©\");\n      setOpen(false);\n      return;\n    }\n\n    try {\n      await api({\n        url: messageId + \"/update\",\n        method: \"put\",\n        data: formData,\n        headers: {\n          Authorization: `Bearer ${token}`,\n          Accept: \"application/json\",\n          \"Content-Type\": \"multipart/from-data\"\n        }\n      });\n      setOpen(false);\n      toastTrigger(\"success\", \"Publication modifi√© üëåüèº\");\n\n      try {\n        const response = await api({\n          url: getMessagesURI,\n          method: \"get\",\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n\n        if (messagesOtherUser) {\n          setMessagesOtherUser(response.data);\n        } else {\n          setAllMessages(response.data);\n        }\n      } catch (error) {\n        toastTrigger(\"error\", \"Une erreur est survenue ‚õîÔ∏è\");\n      }\n    } catch (error) {\n      toastTrigger(\"error\", \"Une erreur est survenue ‚õîÔ∏è\");\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [(myUserId === idUserMessage || admin === true) && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modify-icon\",\n      onClick: handleModal,\n      children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n        color: \"blue\",\n        icon: [\"far\", \"edit\"]\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 11\n      }, this), \" modifier\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(ModifPopUp, {\n      oldAttachement: oldAttachement,\n      open: open,\n      handleModal: handleModal,\n      modalTitle: \"Modifier la publication\",\n      buttonTitle1: \"Sauvegarder Modifications\",\n      buttonTitle2: \"Annuler Modifications\",\n      onUpdate: onUpdate,\n      newTitle: newTitle,\n      newContent: newContent,\n      newFile: newFile,\n      setNewFile: setNewFile,\n      setFileToSend: setFileToSend,\n      setNewTitle: setNewTitle,\n      setNewContent: setNewContent,\n      attachment: attachment\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 5\n  }, this);\n};\n\n_s(ModifyMessage, \"70XMVKeEh6tqcd0rEKX4wfeQyLA=\");\n\n_c = ModifyMessage;\nexport default ModifyMessage;\n\nvar _c;\n\n$RefreshReg$(_c, \"ModifyMessage\");","map":{"version":3,"sources":["/Users/jokizi/Documents/GitHub/BrunettiJoris_7_27052021/frontend/src/components/ModifyMessage/ModifyMessage.js"],"names":["FontAwesomeIcon","api","useState","ModifPopUp","FormData","toastTrigger","ModifyMessage","messagesOtherUser","admin","myUserId","idUserMessage","messageId","title","content","attachment","oldAttachement","setAllMessages","setMessagesOtherUser","getMessagesURI","open","setOpen","newFile","setNewFile","fileToSend","setFileToSend","newTitle","setNewTitle","newContent","setNewContent","handleModal","onUpdate","token","JSON","parse","stringify","sessionStorage","getItem","obj","json","formData","append","url","method","data","headers","Authorization","Accept","response","error"],"mappings":";;;AAAA,SAASA,eAAT,QAAgC,gCAAhC;AACA,OAAOC,GAAP,MAAgB,kBAAhB;AACA,SAASC,QAAT,QAAyB,OAAzB;AACA,OAAOC,UAAP,MAAuB,0BAAvB;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,SAASC,YAAT,QAA6B,oBAA7B;AACA,OAAO,sBAAP;;;AAEA,MAAMC,aAAa,GAAG,CAAC;AACrBC,EAAAA,iBADqB;AAErBC,EAAAA,KAFqB;AAGrBC,EAAAA,QAHqB;AAIrBC,EAAAA,aAJqB;AAKrBC,EAAAA,SALqB;AAMrBC,EAAAA,KANqB;AAOrBC,EAAAA,OAPqB;AAQrBC,EAAAA,UARqB;AASrBC,EAAAA,cATqB;AAUrBC,EAAAA,cAVqB;AAWrBC,EAAAA,oBAXqB;AAYrBC,EAAAA;AAZqB,CAAD,KAahB;AAAA;;AACJ,QAAM,CAACC,IAAD,EAAOC,OAAP,IAAkBlB,QAAQ,CAAC,KAAD,CAAhC;AACA,QAAM,CAACmB,OAAD,EAAUC,UAAV,IAAwBpB,QAAQ,CAACY,UAAD,CAAtC;AACA,QAAM,CAACS,UAAD,EAAaC,aAAb,IAA8BtB,QAAQ,CAAC,EAAD,CAA5C;AACA,QAAM,CAACuB,QAAD,EAAWC,WAAX,IAA0BxB,QAAQ,CAACU,KAAD,CAAxC;AACA,QAAM,CAACe,UAAD,EAAaC,aAAb,IAA8B1B,QAAQ,CAACW,OAAD,CAA5C;;AAEA,QAAMgB,WAAW,GAAG,MAAM;AACxBT,IAAAA,OAAO,CAAC,CAACD,IAAF,CAAP;AACAG,IAAAA,UAAU,CAACP,cAAD,CAAV;AACD,GAHD;;AAKA,QAAMe,QAAQ,GAAG,YAAY;AAC3B,UAAMC,KAAK,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAeC,cAAc,CAACC,OAAf,CAAuB,mBAAvB,CAAf,CAAX,CAAd;AACA,UAAMC,GAAG,GAAG;AAAEzB,MAAAA,KAAK,EAAEa,QAAT;AAAmBZ,MAAAA,OAAO,EAAEc;AAA5B,KAAZ;AACA,UAAMW,IAAI,GAAGN,IAAI,CAACE,SAAL,CAAeG,GAAf,CAAb;AACA,UAAME,QAAQ,GAAG,IAAInC,QAAJ,EAAjB;AACAmC,IAAAA,QAAQ,CAACC,MAAT,CAAgB,OAAhB,EAAyBjB,UAAzB;AACAgB,IAAAA,QAAQ,CAACC,MAAT,CAAgB,SAAhB,EAA2BF,IAA3B;;AACA,QACG1B,KAAK,KAAKa,QAAV,IAAsBZ,OAAO,KAAKc,UAAlC,IAAgDN,OAAO,KAAKN,cAA7D,IACAU,QAAQ,KAAK,EADb,IAEAE,UAAU,KAAK,EAHjB,EAIE;AACAtB,MAAAA,YAAY,CAAC,OAAD,EAAU,sBAAV,CAAZ;AACAe,MAAAA,OAAO,CAAC,KAAD,CAAP;AACA;AACD;;AAED,QAAI;AACF,YAAMnB,GAAG,CAAC;AACRwC,QAAAA,GAAG,EAAE9B,SAAS,GAAG,SADT;AAER+B,QAAAA,MAAM,EAAE,KAFA;AAGRC,QAAAA,IAAI,EAAEJ,QAHE;AAIRK,QAAAA,OAAO,EAAE;AACPC,UAAAA,aAAa,EAAG,UAASd,KAAM,EADxB;AAEPe,UAAAA,MAAM,EAAE,kBAFD;AAGP,0BAAgB;AAHT;AAJD,OAAD,CAAT;AAUA1B,MAAAA,OAAO,CAAC,KAAD,CAAP;AACAf,MAAAA,YAAY,CAAC,SAAD,EAAY,0BAAZ,CAAZ;;AACA,UAAI;AACF,cAAM0C,QAAQ,GAAG,MAAM9C,GAAG,CAAC;AACzBwC,UAAAA,GAAG,EAAEvB,cADoB;AAEzBwB,UAAAA,MAAM,EAAE,KAFiB;AAGzBE,UAAAA,OAAO,EAAE;AAAEC,YAAAA,aAAa,EAAG,UAASd,KAAM;AAAjC;AAHgB,SAAD,CAA1B;;AAKA,YAAIxB,iBAAJ,EAAuB;AACrBU,UAAAA,oBAAoB,CAAC8B,QAAQ,CAACJ,IAAV,CAApB;AACD,SAFD,MAEO;AACL3B,UAAAA,cAAc,CAAC+B,QAAQ,CAACJ,IAAV,CAAd;AACD;AACF,OAXD,CAWE,OAAOK,KAAP,EAAc;AACd3C,QAAAA,YAAY,CAAC,OAAD,EAAU,4BAAV,CAAZ;AACD;AACF,KA3BD,CA2BE,OAAO2C,KAAP,EAAc;AACd3C,MAAAA,YAAY,CAAC,OAAD,EAAU,4BAAV,CAAZ;AACD;AACF,GA/CD;;AAgDA,sBACE;AAAA,eACG,CAACI,QAAQ,KAAKC,aAAb,IAA8BF,KAAK,KAAK,IAAzC,kBACC;AAAK,MAAA,SAAS,EAAC,aAAf;AAA6B,MAAA,OAAO,EAAEqB,WAAtC;AAAA,8BACE,QAAC,eAAD;AAAiB,QAAA,KAAK,EAAC,MAAvB;AAA8B,QAAA,IAAI,EAAE,CAAC,KAAD,EAAQ,MAAR;AAApC;AAAA;AAAA;AAAA;AAAA,cADF;AAAA;AAAA;AAAA;AAAA;AAAA,YAFJ,eAME,QAAC,UAAD;AACE,MAAA,cAAc,EAAEd,cADlB;AAEE,MAAA,IAAI,EAAEI,IAFR;AAGE,MAAA,WAAW,EAAEU,WAHf;AAIE,MAAA,UAAU,EAAC,yBAJb;AAKE,MAAA,YAAY,EAAC,2BALf;AAME,MAAA,YAAY,EAAC,uBANf;AAOE,MAAA,QAAQ,EAAEC,QAPZ;AAQE,MAAA,QAAQ,EAAEL,QARZ;AASE,MAAA,UAAU,EAAEE,UATd;AAUE,MAAA,OAAO,EAAEN,OAVX;AAWE,MAAA,UAAU,EAAEC,UAXd;AAYE,MAAA,aAAa,EAAEE,aAZjB;AAaE,MAAA,WAAW,EAAEE,WAbf;AAcE,MAAA,aAAa,EAAEE,aAdjB;AAeE,MAAA,UAAU,EAAEd;AAfd;AAAA;AAAA;AAAA;AAAA,YANF;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AA0BD,CAnGD;;GAAMR,a;;KAAAA,a;AAoGN,eAAeA,aAAf","sourcesContent":["import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport api from \"../../Config/Api\";\nimport { useState } from \"react\";\nimport ModifPopUp from \"../ModifPopUp/ModifPopUp\";\nimport FormData from \"form-data\";\nimport { toastTrigger } from \"../../helper/toast\";\nimport \"./modify-message.css\";\n\nconst ModifyMessage = ({\n  messagesOtherUser,\n  admin,\n  myUserId,\n  idUserMessage,\n  messageId,\n  title,\n  content,\n  attachment,\n  oldAttachement,\n  setAllMessages,\n  setMessagesOtherUser,\n  getMessagesURI,\n}) => {\n  const [open, setOpen] = useState(false);\n  const [newFile, setNewFile] = useState(attachment);\n  const [fileToSend, setFileToSend] = useState(\"\");\n  const [newTitle, setNewTitle] = useState(title);\n  const [newContent, setNewContent] = useState(content);\n\n  const handleModal = () => {\n    setOpen(!open);\n    setNewFile(oldAttachement);\n  };\n\n  const onUpdate = async () => {\n    const token = JSON.parse(JSON.stringify(sessionStorage.getItem(\"groupomania-token\")));\n    const obj = { title: newTitle, content: newContent };\n    const json = JSON.stringify(obj);\n    const formData = new FormData();\n    formData.append(\"image\", fileToSend);\n    formData.append(\"message\", json);\n    if (\n      (title === newTitle && content === newContent && newFile === oldAttachement) ||\n      newTitle === \"\" ||\n      newContent === \"\"\n    ) {\n      toastTrigger(\"error\", \"Rien n'a √©t√© modifi√©\");\n      setOpen(false);\n      return;\n    }\n\n    try {\n      await api({\n        url: messageId + \"/update\",\n        method: \"put\",\n        data: formData,\n        headers: {\n          Authorization: `Bearer ${token}`,\n          Accept: \"application/json\",\n          \"Content-Type\": \"multipart/from-data\",\n        },\n      });\n      setOpen(false);\n      toastTrigger(\"success\", \"Publication modifi√© üëåüèº\");\n      try {\n        const response = await api({\n          url: getMessagesURI,\n          method: \"get\",\n          headers: { Authorization: `Bearer ${token}` },\n        });\n        if (messagesOtherUser) {\n          setMessagesOtherUser(response.data);\n        } else {\n          setAllMessages(response.data);\n        }\n      } catch (error) {\n        toastTrigger(\"error\", \"Une erreur est survenue ‚õîÔ∏è\");\n      }\n    } catch (error) {\n      toastTrigger(\"error\", \"Une erreur est survenue ‚õîÔ∏è\");\n    }\n  };\n  return (\n    <div>\n      {(myUserId === idUserMessage || admin === true) && (\n        <div className=\"modify-icon\" onClick={handleModal}>\n          <FontAwesomeIcon color=\"blue\" icon={[\"far\", \"edit\"]} /> modifier\n        </div>\n      )}\n      <ModifPopUp\n        oldAttachement={oldAttachement}\n        open={open}\n        handleModal={handleModal}\n        modalTitle=\"Modifier la publication\"\n        buttonTitle1=\"Sauvegarder Modifications\"\n        buttonTitle2=\"Annuler Modifications\"\n        onUpdate={onUpdate}\n        newTitle={newTitle}\n        newContent={newContent}\n        newFile={newFile}\n        setNewFile={setNewFile}\n        setFileToSend={setFileToSend}\n        setNewTitle={setNewTitle}\n        setNewContent={setNewContent}\n        attachment={attachment}\n      />\n    </div>\n  );\n};\nexport default ModifyMessage;\n"]},"metadata":{},"sourceType":"module"}